{% extends "base.html" %} {% block title %} {{ user.username }} {% endblock %}
{% block content %}
    <div class="header-image  card" >
        <img class="header-img" src="{{ user.header_image_url }}" alt="r...">
    </div>


    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <div class="profile-user">
            <img src="{{ user.image_url }}"
                alt="Image for {{ user.username }}"
                class="card-image profile-pic-bg">
        </div>
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="messages-tab" data-bs-toggle="tab" data-bs-target="#messages-tab-pane" type="button" role="tab" aria-controls="messages-tab-pane" aria-selected="true">Messages <div>{{ user.messages | length}}</div></button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="followings-tab" data-bs-toggle="tab" data-bs-target="#followings-tab-pane" type="button" role="tab" aria-controls="followings-tab-pane" aria-selected="false">Followings <div>{{ user.followings | length}}</div></button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="followers-tab" data-bs-toggle="tab" data-bs-target="#followers-tab-pane" type="button" role="tab" aria-controls="followers-tab-pane" aria-selected="false">Followers <div> {{ user.followers | length}}</div></button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="likes-tab" data-bs-toggle="tab" data-bs-target="#likes-tab-pane" type="button" role="tab" aria-controls="likes-tab-pane" aria-selected="false" > Likes <div>{{ user.likes | length }}</div></button>
        </li>
    </ul>
    <div class="card profile-info">
        <div class="card-body">
            <div class="card-text"> <b>@{{ user.username }} </b></div>
            <h4 class="card-title">Bio</h4>
            <div class="card-text">{{user.bio}}</div>
            <h4 class="card-title">Location</h4>
            <div class="card-text">{{ user.location}}</div>

        </div> 
    </div> 
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="messages-tab-pane" role="tabpanel" aria-labelledby="messages-tab" tabindex="0">
            <ul class="list-group">
                {% for msg in user.messages %}
                <li class="list-group-item">
                    <div class="message">
                        <a href="/messages/{{ msg.id  }}">
                            <div>
                                click
                            </div>
                        </a>
                        <div class="">
                            <a class="" href="/users/{{ msg.user.id }}">
                                <img src="{{ msg.user.image_url }}" alt="" class="rounded-circle timeline-image">
                            </a>
                        </div>
                        <div class="message-area">
                            <a href="/users/{{ msg.user.id }}">@{{ msg.user.username }}</a>
                            <span class="text-muted">{{ msg.timestamp.strftime('%d %B %Y') }}</span>
                            <a href="/messages"></a>
                            <p>{{ msg.text }}</p>
                        </div>
                        </a>
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>
        <div class="tab-pane fade" id="followings-tab-pane" role="tabpanel" aria-labelledby="followings-tab" tabindex="0">
            <div class="follow-grid">
                {% for user in user.followings %}
                <div class="card search-card">
                    <img
                        src="{{ user.header_image_url }}"
                        class="search-header-image"
                        alt="..."
                    />
                    <div class="card-body">
                        <div class="search-profile-img">
                            <a href="/users/{{user.id}}">
                                <img src="{{ user.image_url}}" class="profile-pic" alt="" />
                                <div class="card-text">@{{user.username}}</div></a
                            >
                            <div class="card-text">{{user.bio}}</div>
                            {% if g.user.id != user.id %}
                            <div class="follow-btn">
                                {% if user in g.user.followings %}
                                <form action="/users/unfollow/{{user.id}}" method="POST">
                                    <button class="btn btn-primary btn-sm">Unfollow</button>
                                </form>
                                {% else %}
                                <form action="/users/follow/{{user.id}}" method="POST">
                                    <button class="btn btn-outline-primary btn-sm">Follow</button>
                                </form>
                                {% endif %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        <div class="tab-pane fade" id="followers-tab-pane" role="tabpanel" aria-labelledby="followers-tab" tabindex="0">
            <div class="follow-grid ">
                {% for user in user.followers %}
                <div class="card search-card">
                    <img
                        src="{{ user.header_image_url }}"
                        class="search-header-image"
                        alt="..."
                    />
                    <div class="card-body">
                        <div class="search-profile-img">
                            <a href="/users/{{user.id}}">
                                <img src="{{ user.image_url}}" class="profile-pic" alt="" />
                                <div class="card-text">@{{user.username}}</div></a
                            >
                            <div class="card-text">{{user.bio}}</div>
                            {% if g.user.id != user.id %}
                            <div class="follow-btn">
                                {% if user in g.user.followings %}
                                <form action="/users/unfollow/{{user.id}}" method="POST">
                                    <button class="btn btn-primary btn-sm">Unfollow</button>
                                </form>
                                {% else %}
                                <form action="/users/follow/{{user.id}}" method="POST">
                                    <button class="btn btn-outline-primary btn-sm">Follow</button>
                                </form>
                                {% endif %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>


        </div>
        <div class="tab-pane fade" id="likes-tab-pane" role="tabpanel" aria-labelledby="likes-tab" tabindex="0">...</div>
    </div>
{% endblock %}
